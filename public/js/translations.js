// Translation system for Stat4Ballers
const translations = {
    en: {
        // Header
        'Football Statistics Hub': 'Football Statistics Hub',
        'Stat4Ballers': 'Stat4Ballers',

        // Navigation
        'Ligue 1': 'Ligue 1',
        'Premier League': 'Premier League',
        'La Liga': 'La Liga',
        'Serie A': 'Serie A',
        'Bundesliga': 'Bundesliga',

        // Countries
        'France': 'France',
        'England': 'England',
        'Spain': 'Spain',
        'Italy': 'Italy',
        'Germany': 'Germany',

        // Homepage
        'Search for a league, team, or player...': 'Search for a league, team, or player...',
        'Player Comparison': 'Player Comparison',
        'Select up to 4 players to compare their statistics': 'Select up to 4 players to compare their statistics',
        'Select player 1...': 'Select player 1...',
        'Select player 2...': 'Select player 2...',
        'Select player 3 (optional)...': 'Select player 3 (optional)...',
        'Select player 4 (optional)...': 'Select player 4 (optional)...',
        'Compare Players': 'Compare Players',
        'Select at least 2 players': 'Select at least 2 players',
        'Top 5 European Leagues': 'Top 5 European Leagues',
        'Season': 'Season',
        'Features': 'Features',
        'List of statistics': 'List of statistics',
        'Visualize player statistics with up-to-date items by league': 'Visualize player statistics with up-to-date items by league',
        'Live Updates': 'Live Updates',
        'Automatically updated statistics every day': 'Automatically updated statistics every day',
        '3-Season View': '3-Season View',
        'A comprehensive and up-to-date view of your favorite leagues': 'A comprehensive and up-to-date view of your favorite leagues',
        '+30 Player Stats': '+30 Player Stats',
        'Comprehensive statistics for in-depth analysis': 'Comprehensive statistics for in-depth analysis',

        // Footer
        '© 2025 Stat4Ballers. Powered by SportMonks API.': '© 2025 Stat4Ballers. Powered by SportMonks API.',
        '© 2025 Stat4Ballers. Powered by true soccer lovers. For the people, by the people.': '© 2025 Stat4Ballers. Powered by true soccer lovers. For the people, by the people.',
        'Powered by true soccer lovers. For the people, by the people.': 'Powered by true soccer lovers. For the people, by the people.',
        'About': 'About',

        // Player page
        'Player Comparison': 'Player Comparison',
        'Position': 'Position',
        'Team': 'Team',
        'Nationality': 'Nationality',
        'Apps': 'Apps',
        'Minutes': 'Minutes',
        'Yellow': 'Yellow',
        'Red': 'Red',
        'General Statistics': 'General Statistics',
        'Offensive Creativity': 'Offensive Creativity',
        'Defensive Commitment': 'Defensive Commitment',
        'Goalkeeper Specific': 'Goalkeeper Specific',
        'Rating': 'Rating',
        'Appearances': 'Appearances',
        'Minutes played': 'Minutes played',
        'Captain': 'Captain',
        'Goals': 'Goals',
        'Assists': 'Assists',
        'Red cards': 'Red cards',
        'Yellow cards': 'Yellow cards',
        'Shots total': 'Shots total',
        'Shots on target': 'Shots on target',
        'Penalties': 'Penalties',
        'Hit woodwork': 'Hit woodwork',
        'Key passes': 'Key passes',
        'Big chances created': 'Big chances created',
        'Accurate crosses': 'Accurate crosses',
        'Successful dribbles': 'Successful dribbles',
        'Tackles': 'Tackles',
        'Own goals': 'Own goals',
        'Interceptions': 'Interceptions',
        'Duels won': 'Duels won',
        'Aerials won': 'Aerials won',
        'Dispossessed': 'Dispossessed',
        'Dribbled past': 'Dribbled past',
        'Fouls': 'Fouls',
        'Fouls drawn': 'Fouls drawn',
        'Error lead to goal': 'Error lead to goal',
        'Saves': 'Saves',
        'Saves inside box': 'Saves inside box',
        'Goals conceded': 'Goals conceded',
        'Clean sheets': 'Clean sheets',
        'Statistic': 'Statistic',

        // Positions
        'Goalkeeper': 'Goalkeeper',
        'Defender': 'Defender',
        'Midfielder': 'Midfielder',
        'Attacker': 'Attacker',
        'Forward': 'Forward',

        // Comparison page
        'Comparison Summary': 'Comparison Summary',
        'Better than others in:': 'Better than others in:',
        'Balanced performance': 'Balanced performance',
        'Detailed Statistics': 'Detailed Statistics',
        'No players selected': 'No players selected',
        'Please select at least 2 players from the home page to compare their statistics.': 'Please select at least 2 players from the home page to compare their statistics.',
        'Go to Home': 'Go to Home',
        'Back to Home': 'Back to Home',
        '← Back to Home': '← Back to Home',

        // About page - Interview
        'Meeting with the Founder of Stat4Ballers': 'Meeting with the Founder of Stat4Ballers',
        'An exclusive interview with the passionate creator behind Stat4Ballers, where statistics meet the beautiful game.': 'An exclusive interview with the passionate creator behind Stat4Ballers, where statistics meet the beautiful game.',
        'Journalist:': 'Journalist:',
        'Founder:': 'Founder:',
        'What motivated you to create Stat4Ballers?': 'What motivated you to create Stat4Ballers?',
        "Since my childhood, I've been passionate about football. I grew up following multiple leagues and discovering new players every week. For me, football is more than a sport: it's a celebration, a universal language that brings people together. This site was born from this passion, as a way to share this joy and offer a tool for everyone who loves to compare and analyze players.": "Since my childhood, I've been passionate about football. I grew up following multiple leagues and discovering new players every week. For me, football is more than a sport: it's a celebration, a universal language that brings people together. This site was born from this passion, as a way to share this joy and offer a tool for everyone who loves to compare and analyze players.",
        'Who are your main references in your vision of the game?': 'Who are your main references in your vision of the game?',
        'Marcelo Bielsa, for his demanding nature, his almost obsessive methodological knowledge of the game, and his vision of football in society. Also Didier Roustan, for his unique way of narrating the game with poetry and depth. Their approach reinforced my belief that football must remain a means of bringing people together, a spectacle, a moment of escape from daily life where everyone is equal.': 'Marcelo Bielsa, for his demanding nature, his almost obsessive methodological knowledge of the game, and his vision of football in society. Also Didier Roustan, for his unique way of narrating the game with poetry and depth. Their approach reinforced my belief that football must remain a means of bringing people together, a spectacle, a moment of escape from daily life where everyone is equal.',
        "What's the philosophy of Stat4Ballers?": "What's the philosophy of Stat4Ballers?",
        "Here, numbers serve the passion. Stat4Ballers allows you to compare players, but the idea isn't just to produce statistics: it's to give enthusiasts and professionals a simple, fun, and inspiring tool to fuel debates and celebrate the beauty of the game.": "Here, numbers serve the passion. Stat4Ballers allows you to compare players, but the idea isn't just to produce statistics: it's to give enthusiasts and professionals a simple, fun, and inspiring tool to fuel debates and celebrate the beauty of the game.",
        'Who is your site for?': 'Who is your site for?',
        "Everyone. Supporters who want to defend their favorite player, curious minds who love discovering new talents, journalists, consultants, scouts, or coaches looking for clear and quick data to consult. Above all, it's a gift to the great football community.": "Everyone. Supporters who want to defend their favorite player, curious minds who love discovering new talents, journalists, consultants, scouts, or coaches looking for clear and quick data to consult. Above all, it's a gift to the great football community.",
        'A final word for your visitors?': 'A final word for your visitors?',
        'Have fun, compare, debate, and above all... keep loving the game. Because football is here to bring us together, and I could spend my days talking about nothing else. This site is made for people like me, by a guy like you.': 'Have fun, compare, debate, and above all... keep loving the game. Because football is here to bring us together, and I could spend my days talking about nothing else. This site is made for people like me, by a guy like you.'
    },

    fr: {
        // Header
        'Football Statistics Hub': 'Centre de Statistiques Football',
        'Stat4Ballers': 'Stat4Ballers',

        // Navigation
        'Ligue 1': 'Ligue 1',
        'Premier League': 'Premier League',
        'La Liga': 'La Liga',
        'Serie A': 'Serie A',
        'Bundesliga': 'Bundesliga',

        // Countries
        'France': 'France',
        'England': 'Angleterre',
        'Spain': 'Espagne',
        'Italy': 'Italie',
        'Germany': 'Allemagne',

        // Homepage
        'Search for a league, team, or player...': 'Rechercher un championnat, une équipe ou un joueur...',
        'Player Comparison': 'Comparaison de Joueurs',
        'Select up to 4 players to compare their statistics': 'Sélectionnez jusqu\'à 4 joueurs pour comparer leurs statistiques',
        'Select player 1...': 'Sélectionner joueur 1...',
        'Select player 2...': 'Sélectionner joueur 2...',
        'Select player 3 (optional)...': 'Sélectionner joueur 3 (optionnel)...',
        'Select player 4 (optional)...': 'Sélectionner joueur 4 (optionnel)...',
        'Compare Players': 'Comparer les Joueurs',
        'Select at least 2 players': 'Sélectionnez au moins 2 joueurs',
        'Top 5 European Leagues': 'Top 5 Championnats Européens',
        'Season': 'Saison',
        'Features': 'Fonctionnalités',
        'List of statistics': 'Liste de statistiques',
        'Visualize player statistics with up-to-date items by league': 'Visualisez les statistiques des joueurs avec des données à jour par championnat',
        'Live Updates': 'Mises à Jour en Direct',
        'Automatically updated statistics every day': 'Statistiques automatiquement mises à jour chaque jour',
        '3-Season View': 'Vue sur 3 Saisons',
        'A comprehensive and up-to-date view of your favorite leagues': 'Une vue complète et à jour de vos championnats favoris',
        '+30 Player Stats': '+30 Stats Joueurs',
        'Comprehensive statistics for in-depth analysis': 'Statistiques complètes pour une analyse approfondie',

        // Footer
        '© 2025 Stat4Ballers. Powered by SportMonks API.': '© 2025 Stat4Ballers. Propulsé par l\'API SportMonks.',
        '© 2025 Stat4Ballers. Powered by true soccer lovers. For the people, by the people.': '© 2025 Stat4Ballers. Propulsé par de vrais amoureux du football. Pour le peuple, par le peuple.',
        'Powered by true soccer lovers. For the people, by the people.': 'Propulsé par de vrais amoureux du football. Pour le peuple, par le peuple.',
        'About': 'À Propos',

        // Player page
        'Player Comparison': 'Comparaison de Joueurs',
        'Position': 'Position',
        'Team': 'Équipe',
        'Nationality': 'Nationalité',
        'Apps': 'App',
        'Minutes': 'Minutes',
        'Yellow': 'Jaune',
        'Red': 'Rouge',
        'General Statistics': 'Statistiques Générales',
        'Offensive Creativity': 'Créativité Offensive',
        'Defensive Commitment': 'Engagement Défensif',
        'Goalkeeper Specific': 'Spécifique Gardien',
        'Rating': 'Note',
        'Appearances': 'Apparitions',
        'Minutes played': 'Minutes jouées',
        'Captain': 'Capitaine',
        'Goals': 'Buts',
        'Assists': 'Passes décisives',
        'Red cards': 'Cartons rouges',
        'Yellow cards': 'Cartons jaunes',
        'Shots total': 'Tirs totaux',
        'Shots on target': 'Tirs cadrés',
        'Penalties': 'Pénaltys',
        'Hit woodwork': 'Poteaux/barres',
        'Key passes': 'Passes clés',
        'Big chances created': 'Grosses occasions créées',
        'Accurate crosses': 'Centres réussis',
        'Successful dribbles': 'Dribbles réussis',
        'Tackles': 'Tacles',
        'Own goals': 'Buts contre son camp',
        'Interceptions': 'Interceptions',
        'Duels won': 'Duels gagnés',
        'Aerials won': 'Duels aériens gagnés',
        'Dispossessed': 'Dépossédé',
        'Dribbled past': 'Dribblé',
        'Fouls': 'Fautes',
        'Fouls drawn': 'Fautes subies',
        'Error lead to goal': 'Erreur menant au but',
        'Saves': 'Arrêts',
        'Saves inside box': 'Arrêts dans la surface',
        'Goals conceded': 'Buts encaissés',
        'Clean sheets': 'Clean sheets',
        'Statistic': 'Statistique',

        // Positions
        'Goalkeeper': 'Gardien',
        'Defender': 'Défenseur',
        'Midfielder': 'Milieu',
        'Attacker': 'Attaquant',
        'Forward': 'Attaquant',

        // Comparison page
        'Comparison Summary': 'Résumé de la Comparaison',
        'Better than others in:': 'Meilleur que les autres en :',
        'Balanced performance': 'Performance équilibrée',
        'Detailed Statistics': 'Statistiques Détaillées',
        'No players selected': 'Aucun joueur sélectionné',
        'Please select at least 2 players from the home page to compare their statistics.': 'Veuillez sélectionner au moins 2 joueurs depuis la page d\'accueil pour comparer leurs statistiques.',
        'Go to Home': 'Aller à l\'Accueil',
        'Back to Home': 'Retour à l\'Accueil',
        '← Back to Home': '← Retour à l\'Accueil'
    },

    es: {
        // Header
        'Football Statistics Hub': 'Centro de Estadísticas de Fútbol',
        'Stat4Ballers': 'Stat4Ballers',

        // Navigation
        'Ligue 1': 'Ligue 1',
        'Premier League': 'Premier League',
        'La Liga': 'La Liga',
        'Serie A': 'Serie A',
        'Bundesliga': 'Bundesliga',

        // Countries
        'France': 'Francia',
        'England': 'Inglaterra',
        'Spain': 'España',
        'Italy': 'Italia',
        'Germany': 'Alemania',

        // Homepage
        'Search for a league, team, or player...': 'Buscar una liga, equipo o jugador...',
        'Player Comparison': 'Comparación de Jugadores',
        'Select up to 4 players to compare their statistics': 'Selecciona hasta 4 jugadores para comparar sus estadísticas',
        'Select player 1...': 'Seleccionar jugador 1...',
        'Select player 2...': 'Seleccionar jugador 2...',
        'Select player 3 (optional)...': 'Seleccionar jugador 3 (opcional)...',
        'Select player 4 (optional)...': 'Seleccionar jugador 4 (opcional)...',
        'Compare Players': 'Comparar Jugadores',
        'Select at least 2 players': 'Selecciona al menos 2 jugadores',
        'Top 5 European Leagues': 'Top 5 Ligas Europeas',
        'Season': 'Temporada',
        'Features': 'Características',
        'List of statistics': 'Lista de estadísticas',
        'Visualize player statistics with up-to-date items by league': 'Visualiza las estadísticas de jugadores con datos actualizados por liga',
        'Live Updates': 'Actualizaciones en Vivo',
        'Automatically updated statistics every day': 'Estadísticas actualizadas automáticamente cada día',
        '3-Season View': 'Vista de 3 Temporadas',
        'A comprehensive and up-to-date view of your favorite leagues': 'Una vista completa y actualizada de tus ligas favoritas',
        '+30 Player Stats': '+30 Estadísticas de Jugadores',
        'Comprehensive statistics for in-depth analysis': 'Estadísticas completas para un análisis profundo',

        // Footer
        '© 2025 Stat4Ballers. Powered by SportMonks API.': '© 2025 Stat4Ballers. Impulsado por API SportMonks.',
        '© 2025 Stat4Ballers. Powered by true soccer lovers. For the people, by the people.': '© 2025 Stat4Ballers. Impulsado por verdaderos amantes del fútbol. Para la gente, por la gente.',
        'Powered by true soccer lovers. For the people, by the people.': 'Impulsado por verdaderos amantes del fútbol. Para la gente, por la gente.',
        'About': 'Acerca de',

        // Player page
        'Player Comparison': 'Comparación de Jugadores',
        'Position': 'Posición',
        'Team': 'Equipo',
        'Nationality': 'Nacionalidad',
        'Apps': 'Apar',
        'Minutes': 'Minutos',
        'Yellow': 'Amarilla',
        'Red': 'Roja',
        'General Statistics': 'Estadísticas Generales',
        'Offensive Creativity': 'Creatividad Ofensiva',
        'Defensive Commitment': 'Compromiso Defensivo',
        'Goalkeeper Specific': 'Específico Portero',
        'Rating': 'Puntuación',
        'Appearances': 'Apariciones',
        'Minutes played': 'Minutos jugados',
        'Captain': 'Capitán',
        'Goals': 'Goles',
        'Assists': 'Asistencias',
        'Red cards': 'Tarjetas rojas',
        'Yellow cards': 'Tarjetas amarillas',
        'Shots total': 'Tiros totales',
        'Shots on target': 'Tiros a puerta',
        'Penalties': 'Penaltis',
        'Hit woodwork': 'Al palo',
        'Key passes': 'Pases clave',
        'Big chances created': 'Grandes ocasiones creadas',
        'Accurate crosses': 'Centros precisos',
        'Successful dribbles': 'Regates exitosos',
        'Tackles': 'Entradas',
        'Own goals': 'Autogoles',
        'Interceptions': 'Intercepciones',
        'Duels won': 'Duelos ganados',
        'Aerials won': 'Duelos aéreos ganados',
        'Dispossessed': 'Desposeído',
        'Dribbled past': 'Regateado',
        'Fouls': 'Faltas',
        'Fouls drawn': 'Faltas recibidas',
        'Error lead to goal': 'Error que lleva al gol',
        'Saves': 'Paradas',
        'Saves inside box': 'Paradas en el área',
        'Goals conceded': 'Goles encajados',
        'Clean sheets': 'Porterías imbatidas',
        'Statistic': 'Estadística',

        // Positions
        'Goalkeeper': 'Portero',
        'Defender': 'Defensa',
        'Midfielder': 'Centrocampista',
        'Attacker': 'Delantero',
        'Forward': 'Delantero',

        // Comparison page
        'Comparison Summary': 'Resumen de Comparación',
        'Better than others in:': 'Mejor que otros en:',
        'Balanced performance': 'Rendimiento equilibrado',
        'Detailed Statistics': 'Estadísticas Detalladas',
        'No players selected': 'No hay jugadores seleccionados',
        'Please select at least 2 players from the home page to compare their statistics.': 'Por favor, selecciona al menos 2 jugadores desde la página de inicio para comparar sus estadísticas.',
        'Go to Home': 'Ir al Inicio',
        'Back to Home': 'Volver al Inicio',
        '← Back to Home': '← Volver al Inicio'
    },

    pt: {
        // Header
        'Football Statistics Hub': 'Centro de Estatísticas de Futebol',
        'Stat4Ballers': 'Stat4Ballers',

        // Navigation
        'Ligue 1': 'Ligue 1',
        'Premier League': 'Premier League',
        'La Liga': 'La Liga',
        'Serie A': 'Serie A',
        'Bundesliga': 'Bundesliga',

        // Countries
        'France': 'França',
        'England': 'Inglaterra',
        'Spain': 'Espanha',
        'Italy': 'Itália',
        'Germany': 'Alemanha',

        // Homepage
        'Search for a league, team, or player...': 'Pesquisar uma liga, equipa ou jogador...',
        'Player Comparison': 'Comparação de Jogadores',
        'Select up to 4 players to compare their statistics': 'Selecione até 4 jogadores para comparar suas estatísticas',
        'Select player 1...': 'Selecionar jogador 1...',
        'Select player 2...': 'Selecionar jogador 2...',
        'Select player 3 (optional)...': 'Selecionar jogador 3 (opcional)...',
        'Select player 4 (optional)...': 'Selecionar jogador 4 (opcional)...',
        'Compare Players': 'Comparar Jogadores',
        'Select at least 2 players': 'Selecione pelo menos 2 jogadores',
        'Top 5 European Leagues': 'Top 5 Ligas Europeias',
        'Season': 'Temporada',
        'Features': 'Funcionalidades',
        'List of statistics': 'Lista de estatísticas',
        'Visualize player statistics with up-to-date items by league': 'Visualize as estatísticas dos jogadores com dados atualizados por liga',
        'Live Updates': 'Atualizações ao Vivo',
        'Automatically updated statistics every day': 'Estatísticas atualizadas automaticamente todos os dias',
        '3-Season View': 'Vista de 3 Temporadas',
        'A comprehensive and up-to-date view of your favorite leagues': 'Uma visão abrangente e atualizada das suas ligas favoritas',
        '+30 Player Stats': '+30 Estatísticas de Jogadores',
        'Comprehensive statistics for in-depth analysis': 'Estatísticas abrangentes para análise aprofundada',

        // Footer
        '© 2025 Stat4Ballers. Powered by SportMonks API.': '© 2025 Stat4Ballers. Desenvolvido pela API SportMonks.',
        '© 2025 Stat4Ballers. Powered by true soccer lovers. For the people, by the people.': '© 2025 Stat4Ballers. Desenvolvido por verdadeiros amantes do futebol. Para o povo, pelo povo.',
        'Powered by true soccer lovers. For the people, by the people.': 'Desenvolvido por verdadeiros amantes do futebol. Para o povo, pelo povo.',
        'About': 'Sobre',

        // Player page
        'Player Comparison': 'Comparação de Jogadores',
        'Position': 'Posição',
        'Team': 'Equipa',
        'Nationality': 'Nacionalidade',
        'Apps': 'Jogos',
        'Minutes': 'Minutos',
        'Yellow': 'Amarelo',
        'Red': 'Vermelho',
        'General Statistics': 'Estatísticas Gerais',
        'Offensive Creativity': 'Criatividade Ofensiva',
        'Defensive Commitment': 'Compromisso Defensivo',
        'Goalkeeper Specific': 'Específico Guarda-redes',
        'Rating': 'Classificação',
        'Appearances': 'Aparições',
        'Minutes played': 'Minutos jogados',
        'Captain': 'Capitão',
        'Goals': 'Golos',
        'Assists': 'Assistências',
        'Red cards': 'Cartões vermelhos',
        'Yellow cards': 'Cartões amarelos',
        'Shots total': 'Remates totais',
        'Shots on target': 'Remates à baliza',
        'Penalties': 'Pênaltis',
        'Hit woodwork': 'Na trave',
        'Key passes': 'Passes chave',
        'Big chances created': 'Grandes oportunidades criadas',
        'Accurate crosses': 'Cruzamentos precisos',
        'Successful dribbles': 'Dribles bem-sucedidos',
        'Tackles': 'Desarmes',
        'Own goals': 'Autogolos',
        'Interceptions': 'Interceções',
        'Duels won': 'Duelos ganhos',
        'Aerials won': 'Duelos aéreos ganhos',
        'Dispossessed': 'Desarmado',
        'Dribbled past': 'Driblado',
        'Fouls': 'Faltas',
        'Fouls drawn': 'Faltas sofridas',
        'Error lead to goal': 'Erro que levou ao golo',
        'Saves': 'Defesas',
        'Saves inside box': 'Defesas na área',
        'Goals conceded': 'Golos sofridos',
        'Clean sheets': 'Jogos sem sofrer golos',
        'Statistic': 'Estatística',

        // Positions
        'Goalkeeper': 'Guarda-redes',
        'Defender': 'Defensor',
        'Midfielder': 'Médio',
        'Attacker': 'Avançado',
        'Forward': 'Avançado',

        // Comparison page
        'Comparison Summary': 'Resumo da Comparação',
        'Better than others in:': 'Melhor que outros em:',
        'Balanced performance': 'Desempenho equilibrado',
        'Detailed Statistics': 'Estatísticas Detalhadas',
        'No players selected': 'Nenhum jogador selecionado',
        'Please select at least 2 players from the home page to compare their statistics.': 'Por favor, selecione pelo menos 2 jogadores na página inicial para comparar suas estatísticas.',
        'Go to Home': 'Ir para o Início',
        'Back to Home': 'Voltar ao Início',
        '← Back to Home': '← Voltar ao Início'
    }
};

// Translation function
function translatePage(lang) {
    if (!translations[lang]) {
        console.warn(`Language ${lang} not supported`);
        return;
    }

    // Translate elements with data-translate attribute
    const elementsToTranslate = document.querySelectorAll('[data-translate]');
    elementsToTranslate.forEach(element => {
        const key = element.getAttribute('data-translate');
        if (translations[lang][key]) {
            if (element.tagName === 'INPUT' || element.tagName === 'TEXTAREA') {
                element.placeholder = translations[lang][key];
            } else {
                element.textContent = translations[lang][key];
            }
        }
    });

    // Translate all placeholders (even without data-translate)
    document.querySelectorAll('input[placeholder], textarea[placeholder]').forEach(element => {
        const placeholder = element.placeholder;
        if (translations[lang][placeholder]) {
            element.placeholder = translations[lang][placeholder];
        }
    });

    // Translate text nodes directly
    translateTextNodes(document.body, lang);

    // Update language buttons
    document.querySelectorAll('.lang-btn').forEach(btn => {
        btn.classList.toggle('active', btn.dataset.lang === lang);
    });

    // Save preference
    localStorage.setItem('preferredLanguage', lang);

    // Update HTML lang attribute
    document.documentElement.lang = lang;
}

// Function to translate text nodes
function translateTextNodes(element, lang) {
    const treeWalker = document.createTreeWalker(
        element,
        NodeFilter.SHOW_TEXT,
        {
            acceptNode: function(node) {
                // Skip script and style tags
                if (node.parentElement.tagName === 'SCRIPT' ||
                    node.parentElement.tagName === 'STYLE' ||
                    node.parentElement.classList.contains('no-translate')) {
                    return NodeFilter.FILTER_REJECT;
                }
                // Only process non-empty text nodes
                if (node.nodeValue.trim()) {
                    return NodeFilter.FILTER_ACCEPT;
                }
                return NodeFilter.FILTER_REJECT;
            }
        }
    );

    const textNodes = [];
    while (treeWalker.nextNode()) {
        textNodes.push(treeWalker.currentNode);
    }

    textNodes.forEach(node => {
        const text = node.nodeValue.trim();
        if (translations[lang][text]) {
            node.nodeValue = node.nodeValue.replace(text, translations[lang][text]);
        }
    });
}

// Initialize on page load
document.addEventListener('DOMContentLoaded', () => {
    // Get saved language or default to English
    const savedLang = localStorage.getItem('preferredLanguage') || 'en';

    // Always apply translations to ensure consistency
    translatePage(savedLang);

    // Add event listeners to language buttons
    document.querySelectorAll('.lang-btn').forEach(btn => {
        btn.addEventListener('click', (e) => {
            const lang = e.target.dataset.lang;
            translatePage(lang);
        });
    });
});

// Also run on page show (for when navigating back)
window.addEventListener('pageshow', () => {
    const savedLang = localStorage.getItem('preferredLanguage') || 'en';
    if (savedLang !== 'en') {
        translatePage(savedLang);
    }
});

// Export for use in other scripts
window.translatePage = translatePage;
window.translations = translations;